# new/malloc和delete/free的区别

1. malloc和feree是C语言中的库函数，new和delete是C++中的操作符

2. new根据对象类型自动计算所需分配内存大小，malloc需要手动指定分配内存大小

3. new的返回值是对象类型的指针，malloc返回void * 

4. new分配失败会返回异常，malloc分配失败返回NULL

5. new操作符从**自由存储区（free store）**上为对象动态分配内存空间

    malloc函数从**堆**上动态分配内存，小于128K使用break系统调用，超过128K后使用mmap系统调用可能分配的是文件映射区

    > 自由存储区是C++基于new操作符的一个抽象概念，凡是通过new操作符进行内存申请，该内存即为自由存储区。
    >
    > 而堆是操作系统中的术语，是操作系统所维护的一块特殊内存，用于程序的内存动态分配，C语言使用malloc从堆上分配内存，使用free释放已分配的对应内存。

6. malloc与new都会分配虚拟内存，但是malloc分配完后因为没有初始化所以不一定会有物理内存，而new因为会调用构造函数所以会分配物理内存

7. delete需要对象类型的指针，因为要调用析构函数，而free使用void*类型的指针